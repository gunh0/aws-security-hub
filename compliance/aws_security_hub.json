{
    "Framework": "AWS-Security-Hub",
    "Version": "0.1",
    "Provider": "AWS",
    "Description": "The AWS Security Hub compliance pack provides a set of security and compliance checks that help you maintain the security posture of your AWS environment.",
    "Requirements": [
        {
            "Id": "APIGateway.1",
            "Description": "API Gateway REST and WebSocket API execution logging should be enabled",
            "Checks": [
                "api-gw-execution-logging-enabled"
            ],
            "Attributes": [
                {
                    "Section": "Amazon API Gateway controls",
                    "RelatedRequirements": "NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",
                    "Category": "Identify > Logging",
                    "Severity": "Medium",
                    "Description": "This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if the loggingLevel isn't ERROR or INFO for all stages of the API. Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the logging level is either ERROR or INFO."
                }
            ]
        },
        {
            "Id": "APIGateway.2",
            "Description": "API Gateway REST API stages should be configured to use SSL certificates for backend authentication",
            "Checks": [
                "api-gw-ssl-enabled"
            ],
            "Attributes": [
                {
                    "Section": "Amazon API Gateway controls",
                    "RelatedRequirements": "NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",
                    "Category": "Protect > Data Protection > Encryption of data-in-transit",
                    "Severity": "Medium",
                    "Description": "This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. Backend systems use these certificates to authenticate that incoming requests are from API Gateway."
                }
            ]
        },
        {
            "Id": "DocumentDB.1",
            "Description": "Amazon DocumentDB clusters should have encryption at rest enabled",
            "Checks": [
                "docdb-cluster-encrypted"
            ],
            "Attributes": [
                {
                    "Section": "Amazon DocumentDB controls",
                    "RelatedRequirements": "NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",
                    "Category": "Protect > Data Protection > Encryption of data-at-rest",
                    "Severity": "Medium",
                    "Description": "This control checks whether an Amazon DocumentDB cluster is encrypted at rest. The control fails if an Amazon DocumentDB cluster isn't encrypted at rest."
                }
            ]
        },
        {
            "Id": "EC2.1",
            "Description": "Amazon EBS snapshots should not be publicly restorable",
            "Checks": [
                "ebs-snapshots-public-restorable-check"
            ],
            "Attributes": [
                {
                    "Section": "Amazon EC2 controls",
                    "RelatedRequirements": "PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",
                    "Category": "Protect > Secure network configuration",
                    "Severity": "Critical",
                    "Description": "This control checks whether Amazon Elastic Block Store snapshots are not public. The control fails if Amazon EBS snapshots are restorable by anyone."
                }
            ]
        }
    ]
}